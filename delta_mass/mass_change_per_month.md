Mass change - phase 1 per month
================
Selina Agbayani
Jan 19, 2021, updated and cleaned 04 July, 2025

NOTE: This code will run for a long time.

``` r
############ Set path for output figures: ###############
Figurespath <- paste0(getwd(), "/figures", collapse = NULL)

############ Set path for input & output data  ###########
datapath <- paste0(getwd(), "/data", collapse = NULL) 
```

``` r
## Read data in

#Read in predicted lengths from Agbayani et al. 2020
gw_pred_lengths <- as_tibble(
  read_csv("data/gw_predicted_phases_1_2_mthsversion_Feb2021.csv"),
  col_types = (list(
    cols(age_yrs = col_double(),
         fit = col_double(),
         mean = col_double(),
         sd = col_double(),
         median = col_double(),
         median_abs_dev = col_double(),
         `2.5%` = col_double(),
         `97.5%` = col_double(),
         length_plus_sd = col_double(),
         length_minus_sd = col_double(),
         female_length = col_double(),
         male_length = col_double()
    )
  )
  )
)
```

    ## Rows: 1506 Columns: 10
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (10): age_yrs, fit, mean, sd, median, median_abs_dev, 2.5%, 97.5%, lengt...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
#Read in predicted mass from mass_boostraps.Rmd
gw_pred_mass <- as_tibble(
  read_csv("data/mass_table.csv"), #monthly 
  col_types = (list(
    cols(age_yrs = col_double(),
         mean_mass = col_double(),
         sd_mass = col_double(),
         mean_lwr = col_double(),
         mean_upr = col_double(),
         quant025 = col_double(),
         quant975 = col_double(),
         female_mass = col_double(),
         male_mass = col_double()
    )
  )
  )
)
```

    ## Rows: 173 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (9): age_yrs, mean_mass, sd_mass, mean_lwr, mean_upr, quant025, quant975...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
#read in age table (months converted to decimal yr)
age_yr_tibble <- as_tibble(
  read_csv("data/age_yr_tibble.csv"), 
  col_types = (list(ID = col_integer(),
                    month = col_character(),
                    no_days_in_mth = col_double(),
                    age_mth = col_double(),
                    no_days_cumul = col_double(),
                    age_yrs = col_double()
  )
  )
)
```

    ## Rows: 25 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): month
    ## dbl (4): no_days_in_mth, age_mth, no_days_cumul, age_yrs
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Calculate change in mass per month (up to 1 yr).

``` r
#Original code was run with MC_reps <- 10000  and took a very long time
#To test and explore the code, use less reps 
MC_reps <- 10

kable(gw_pred_mass)
```

| age_yrs | mean_mass | sd_mass | mean_lwr | mean_upr | quant025 | quant975 | female_mass | male_mass |
|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 0.0000000 | 983.0272 | 26.76770 | 769.3864 | 1256.003 | 931.5244 | 1036.295 | 1011.028 | 967.3705 |
| 0.0424658 | 1232.8231 | 30.08225 | 990.0386 | 1535.157 | 1174.8634 | 1292.607 | 1267.939 | 1213.1879 |
| 0.0849315 | 1498.2581 | 37.14344 | 1229.5370 | 1825.723 | 1426.7071 | 1572.089 | 1540.935 | 1474.3954 |
| 0.1232877 | 1747.8713 | 45.25512 | 1458.4778 | 2094.703 | 1660.7409 | 1837.873 | 1797.658 | 1720.0329 |
| 0.1616438 | 2003.8171 | 53.21868 | 1696.1860 | 2367.260 | 1901.3875 | 2109.690 | 2060.895 | 1971.9023 |
| 0.2041096 | 2291.4431 | 62.29993 | 1966.1135 | 2670.624 | 2171.5715 | 2415.419 | 2356.713 | 2254.9473 |
| 0.2465753 | 2580.5024 | 70.55082 | 2239.6310 | 2973.274 | 2444.7652 | 2720.907 | 2654.006 | 2539.4028 |
| 0.2876712 | 2859.0329 | 76.53073 | 2504.6919 | 3263.521 | 2711.7497 | 3011.297 | 2940.471 | 2813.4971 |
| 0.3287671 | 3134.3355 | 82.72707 | 2767.6103 | 3549.671 | 2975.0985 | 3298.899 | 3223.615 | 3084.4149 |
| 0.3712329 | 3413.5230 | 86.53765 | 3034.7044 | 3839.644 | 3246.8671 | 3585.582 | 3510.755 | 3359.1559 |
| 0.4136986 | 3685.8679 | 90.88511 | 3295.2869 | 4122.756 | 3510.7807 | 3866.512 | 3790.858 | 3627.1630 |
| 0.4547945 | 3941.6511 | 91.42970 | 3539.7234 | 4389.226 | 3765.3901 | 4123.252 | 4053.927 | 3878.8724 |
| 0.4958904 | 4188.9977 | 92.45919 | 3775.5555 | 4647.721 | 4010.6552 | 4372.546 | 4308.319 | 4122.2796 |
| 0.5383562 | 4434.9913 | 91.82531 | 4009.3493 | 4905.825 | 4257.7544 | 4617.163 | 4561.319 | 4364.3552 |
| 0.5808219 | 4670.7728 | 91.41471 | 4232.5596 | 5154.359 | 4494.2320 | 4852.033 | 4803.817 | 4596.3814 |
| 0.6232877 | 4896.0196 | 91.08355 | 4444.8610 | 5392.974 | 4720.0362 | 5076.540 | 5035.480 | 4818.0407 |
| 0.6657534 | 5110.5620 | 90.42769 | 4646.1276 | 5621.423 | 4935.7692 | 5289.706 | 5256.133 | 5029.1660 |
| 0.7068493 | 5307.9930 | 91.27160 | 4830.4602 | 5832.735 | 5131.5266 | 5488.766 | 5459.188 | 5223.4526 |
| 0.7479452 | 5495.4655 | 93.44847 | 5004.6710 | 6034.392 | 5314.7738 | 5680.533 | 5652.001 | 5407.9392 |
| 0.7904110 | 5678.8683 | 96.36957 | 5174.2964 | 6232.644 | 5492.5252 | 5869.718 | 5840.627 | 5588.4210 |
| 0.8328767 | 5802.7365 | 211.64097 | 5287.9733 | 6367.611 | 5397.3545 | 6225.735 | 5968.024 | 5710.3163 |
| 0.8739726 | 5869.1305 | 208.61037 | 5348.9964 | 6439.843 | 5469.3720 | 6285.891 | 6036.309 | 5775.6529 |
| 0.9150685 | 5935.5799 | 207.14747 | 5409.9546 | 6512.275 | 5538.4997 | 6349.293 | 6104.651 | 5841.0440 |
| 0.9575342 | 6004.2031 | 204.11616 | 5472.8012 | 6587.204 | 5612.7610 | 6411.690 | 6175.229 | 5908.5742 |
| 1.0000000 | 6072.8559 | 202.11091 | 5535.5539 | 6662.311 | 5685.3490 | 6476.221 | 6245.837 | 5976.1335 |
| 1.5000000 | 6878.9486 | 179.31254 | 6263.7313 | 7554.594 | 6533.7447 | 7235.588 | 7074.891 | 6769.3876 |
| 2.0000000 | 7675.1795 | 162.24501 | 6967.9413 | 8454.206 | 7362.0875 | 7997.123 | 7893.802 | 7552.9369 |
| 2.5000000 | 8454.3471 | 151.60756 | 7643.9406 | 9350.680 | 8161.3299 | 8754.726 | 8695.164 | 8319.6947 |
| 3.0000000 | 9210.7914 | 147.98488 | 8289.2833 | 10234.752 | 8924.5190 | 9503.733 | 9473.155 | 9064.0911 |
| 3.5000000 | 9940.1731 | 149.81941 | 8902.5855 | 11098.702 | 9650.2132 | 10236.606 | 10223.313 | 9781.8560 |
| 4.0000000 | 10639.3400 | 156.47161 | 9483.1963 | 11936.449 | 10336.4523 | 10948.882 | 10942.395 | 10469.8872 |
| 4.5000000 | 11306.1006 | 165.35347 | 10030.9696 | 12743.342 | 10986.0074 | 11633.200 | 11628.148 | 11126.0283 |
| 5.0000000 | 11939.1149 | 175.29879 | 10546.1836 | 13516.043 | 11599.7789 | 12285.898 | 12279.193 | 11748.9607 |
| 5.5000000 | 12537.6997 | 183.46603 | 11029.4207 | 14252.259 | 12182.5454 | 12900.631 | 12894.828 | 12338.0117 |
| 6.0000000 | 13101.8125 | 192.36749 | 11481.5758 | 14950.716 | 12729.4356 | 13482.361 | 13475.010 | 12893.1400 |
| 6.5000000 | 13631.7350 | 196.84644 | 11903.6551 | 15610.711 | 13250.6435 | 14021.099 | 14020.027 | 13414.6223 |
| 7.0000000 | 14128.1995 | 198.04621 | 12296.8789 | 16232.278 | 13744.7075 | 14519.858 | 14530.633 | 13903.1797 |
| 7.5000000 | 14592.2993 | 203.15164 | 12662.6310 | 16816.060 | 14198.9031 | 14994.036 | 15007.952 | 14359.8877 |
| 8.0000000 | 15025.0545 | 201.70744 | 13002.1734 | 17362.684 | 14634.3618 | 15423.841 | 15453.034 | 14785.7505 |
| 8.5000000 | 15427.8977 | 200.74318 | 13316.9862 | 17873.443 | 15038.9956 | 15824.700 | 15867.352 | 15182.1775 |
| 9.0000000 | 15802.2199 | 198.44641 | 13608.4659 | 18349.646 | 15417.6838 | 16194.397 | 16252.336 | 15550.5379 |
| 9.5000000 | 16149.5266 | 196.91668 | 13878.0373 | 18792.829 | 15767.8879 | 16538.613 | 16609.536 | 15892.3131 |
| 10.0000000 | 16471.2552 | 191.76991 | 14127.0359 | 19204.496 | 16099.4933 | 16850.073 | 16940.429 | 16208.9176 |
| 10.5000000 | 16768.9745 | 187.85341 | 14356.8479 | 19586.392 | 16404.7282 | 17139.978 | 17246.629 | 16501.8950 |
| 11.0000000 | 17044.1369 | 183.20003 | 14568.7462 | 19940.147 | 16688.8362 | 17405.872 | 17529.629 | 16772.6749 |
| 11.5000000 | 17298.2066 | 179.21892 | 14763.9818 | 20267.451 | 16950.5624 | 17652.015 | 17790.935 | 17022.6981 |
| 12.0000000 | 17532.5649 | 174.52514 | 14943.7219 | 20569.919 | 17193.9597 | 17877.040 | 18031.969 | 17253.3237 |
| 12.5000000 | 17748.5734 | 170.38431 | 15109.0970 | 20849.172 | 17417.9460 | 18084.819 | 18254.131 | 17465.8919 |
| 13.0000000 | 17947.5174 | 166.80925 | 15261.1640 | 21106.756 | 17623.7800 | 18276.659 | 18458.741 | 17661.6673 |
| 13.5000000 | 18130.6213 | 164.02731 | 15400.9199 | 21344.161 | 17812.2453 | 18454.236 | 18647.061 | 17841.8549 |
| 14.0000000 | 18299.0278 | 160.90657 | 15529.2890 | 21562.783 | 17986.6712 | 18616.447 | 18820.264 | 18007.5791 |
| 14.5000000 | 18453.8506 | 159.39128 | 15647.1612 | 21764.003 | 18144.4125 | 18768.257 | 18979.497 | 18159.9361 |
| 15.0000000 | 18596.1032 | 158.57142 | 15755.3449 | 21949.080 | 18288.2406 | 18908.876 | 19125.802 | 18299.9231 |
| 15.5000000 | 18726.7452 | 158.39082 | 15854.5996 | 22119.212 | 18419.2230 | 19039.151 | 19260.165 | 18428.4843 |
| 16.0000000 | 18846.6639 | 158.01341 | 15945.6255 | 22275.514 | 18539.8637 | 19158.315 | 19383.500 | 18546.4931 |
| 16.5000000 | 18956.7165 | 159.15827 | 16029.0924 | 22419.072 | 18647.6952 | 19270.627 | 19496.687 | 18654.7929 |
| 17.0000000 | 19057.6668 | 160.54496 | 16105.5982 | 22550.851 | 18745.9573 | 19374.317 | 19600.513 | 18754.1353 |
| 17.5000000 | 19150.2370 | 162.06850 | 16175.7051 | 22671.770 | 18835.5752 | 19469.898 | 19695.720 | 18845.2312 |
| 18.0000000 | 19235.1086 | 164.60951 | 16239.9406 | 22782.700 | 18915.5279 | 19559.796 | 19783.009 | 18928.7510 |
| 18.5000000 | 19312.8985 | 167.75847 | 16298.7822 | 22884.431 | 18987.2243 | 19643.817 | 19863.015 | 19005.3020 |
| 19.0000000 | 19384.1695 | 170.48567 | 16352.6650 | 22977.682 | 19053.2180 | 19720.485 | 19936.316 | 19075.4378 |
| 19.5000000 | 19449.4612 | 173.50431 | 16402.0036 | 23063.150 | 19112.6701 | 19791.753 | 20003.467 | 19139.6897 |
| 20.0000000 | 19509.2648 | 176.86174 | 16447.1749 | 23141.467 | 19165.9803 | 19858.204 | 20064.974 | 19198.5407 |
| 20.5000000 | 19564.0274 | 180.15855 | 16488.5222 | 23213.210 | 19214.3679 | 19919.495 | 20121.297 | 19252.4312 |
| 21.0000000 | 19614.1637 | 183.21227 | 16526.3629 | 23278.914 | 19258.5998 | 19975.680 | 20172.861 | 19301.7689 |
| 21.5000000 | 19660.0652 | 186.67641 | 16560.9953 | 23339.089 | 19297.8051 | 20028.444 | 20220.070 | 19346.9393 |
| 22.0000000 | 19702.0797 | 190.13030 | 16592.6853 | 23394.184 | 19333.1445 | 20077.302 | 20263.281 | 19388.2847 |
| 22.5000000 | 19740.5327 | 193.63683 | 16621.6806 | 23444.623 | 19364.8218 | 20122.704 | 20302.830 | 19426.1252 |
| 23.0000000 | 19775.7153 | 196.63985 | 16648.2035 | 23490.783 | 19394.2022 | 20163.838 | 20339.014 | 19460.7475 |
| 23.5000000 | 19807.9144 | 200.15091 | 16672.4709 | 23533.039 | 19419.6192 | 20202.998 | 20372.131 | 19492.4337 |
| 24.0000000 | 19837.3702 | 203.28231 | 16694.6663 | 23571.703 | 19443.0270 | 20238.662 | 20402.426 | 19521.4204 |
| 24.5000000 | 19864.3083 | 205.64043 | 16714.9611 | 23607.067 | 19465.4107 | 20270.276 | 20430.131 | 19547.9295 |
| 25.0000000 | 19888.9637 | 208.99851 | 16733.5317 | 23639.442 | 19483.5824 | 20301.591 | 20455.489 | 19572.1922 |
| 25.5000000 | 19911.5098 | 211.76532 | 16750.5112 | 23669.052 | 19500.7869 | 20329.625 | 20478.677 | 19594.3792 |
| 26.0000000 | 19932.1282 | 214.20988 | 16766.0367 | 23696.133 | 19516.6862 | 20355.093 | 20499.883 | 19614.6691 |
| 26.5000000 | 19950.9871 | 216.72239 | 16780.2352 | 23720.907 | 19530.6957 | 20378.936 | 20519.279 | 19633.2278 |
| 27.0000000 | 19968.2319 | 218.97347 | 16793.2169 | 23743.564 | 19543.5960 | 20400.647 | 20537.015 | 19650.1979 |
| 27.5000000 | 19984.0055 | 221.41109 | 16805.0893 | 23764.290 | 19554.6658 | 20421.258 | 20553.238 | 19665.7203 |
| 28.0000000 | 19998.4263 | 223.50240 | 16815.9426 | 23783.240 | 19565.0513 | 20439.829 | 20568.069 | 19679.9113 |
| 28.5000000 | 20011.6137 | 225.58917 | 16825.8664 | 23800.572 | 19574.2128 | 20457.159 | 20581.632 | 19692.8887 |
| 29.0000000 | 20023.6686 | 227.35530 | 16834.9375 | 23816.416 | 19582.8605 | 20472.719 | 20594.031 | 19704.7517 |
| 29.5000000 | 20034.6892 | 228.93194 | 16843.2296 | 23830.902 | 19590.8397 | 20486.869 | 20605.365 | 19715.5968 |
| 30.0000000 | 20044.7717 | 230.90544 | 16850.8147 | 23844.156 | 19597.1158 | 20500.870 | 20615.735 | 19725.5186 |
| 30.5000000 | 20053.9883 | 232.65938 | 16857.7480 | 23856.273 | 19602.9498 | 20513.569 | 20625.214 | 19734.5884 |
| 31.0000000 | 20062.4119 | 234.13430 | 16864.0845 | 23867.348 | 19608.5290 | 20524.921 | 20633.877 | 19742.8779 |
| 31.5000000 | 20070.1111 | 235.40377 | 16869.8759 | 23877.471 | 19613.7801 | 20535.141 | 20641.796 | 19750.4544 |
| 32.0000000 | 20077.1538 | 236.90061 | 16875.1728 | 23886.731 | 19617.9367 | 20545.157 | 20649.039 | 19757.3849 |
| 32.5000000 | 20083.5879 | 238.01889 | 16880.0121 | 23895.192 | 19622.2146 | 20553.812 | 20655.657 | 19763.7166 |
| 33.0000000 | 20089.4721 | 239.24366 | 16884.4373 | 23902.930 | 19625.7374 | 20562.128 | 20661.708 | 19769.5070 |
| 33.5000000 | 20094.8497 | 240.30205 | 16888.4814 | 23910.002 | 19629.0746 | 20569.608 | 20667.239 | 19774.7990 |
| 34.0000000 | 20099.7640 | 241.19456 | 16892.1771 | 23916.464 | 19632.2683 | 20576.295 | 20672.294 | 19779.6351 |
| 34.5000000 | 20104.2603 | 242.32323 | 16895.5580 | 23922.378 | 19634.5889 | 20583.034 | 20676.918 | 19784.0597 |
| 35.0000000 | 20108.3657 | 243.05300 | 16898.6452 | 23927.777 | 19637.2875 | 20588.589 | 20681.140 | 19788.0997 |
| 35.5000000 | 20112.1218 | 243.98576 | 16901.4693 | 23932.718 | 19639.2458 | 20594.198 | 20685.003 | 19791.7961 |
| 36.0000000 | 20115.5526 | 244.67139 | 16904.0490 | 23937.230 | 19641.3550 | 20598.991 | 20688.532 | 19795.1722 |
| 36.5000000 | 20118.6901 | 245.42975 | 16906.4079 | 23941.357 | 19643.0309 | 20603.635 | 20691.759 | 19798.2597 |
| 37.0000000 | 20121.5573 | 246.09516 | 16908.5637 | 23945.129 | 19644.6157 | 20607.824 | 20694.708 | 19801.0813 |
| 37.5000000 | 20124.1779 | 246.69998 | 16910.5339 | 23948.576 | 19646.0706 | 20611.646 | 20697.403 | 19803.6601 |
| 38.0000000 | 20126.5732 | 247.26839 | 16912.3347 | 23951.727 | 19647.3705 | 20615.171 | 20699.866 | 19806.0172 |
| 38.5000000 | 20128.7633 | 247.85377 | 16913.9812 | 23954.608 | 19648.4325 | 20618.524 | 20702.119 | 19808.1725 |
| 39.0000000 | 20130.7645 | 248.35799 | 16915.4857 | 23957.241 | 19649.4621 | 20621.527 | 20704.177 | 19810.1419 |
| 39.5000000 | 20132.5935 | 248.81639 | 16916.8606 | 23959.647 | 19650.4078 | 20624.267 | 20706.058 | 19811.9417 |
| 40.0000000 | 20134.2655 | 249.25841 | 16918.1175 | 23961.846 | 19651.2279 | 20626.818 | 20707.778 | 19813.5870 |
| 40.5000000 | 20135.7932 | 249.64164 | 16919.2660 | 23963.856 | 19652.0172 | 20629.107 | 20709.349 | 19815.0904 |
| 41.0000000 | 20137.1903 | 250.05155 | 16920.3161 | 23965.694 | 19652.6245 | 20631.319 | 20710.786 | 19816.4653 |
| 41.5000000 | 20138.4663 | 250.36358 | 16921.2753 | 23967.373 | 19653.2992 | 20633.215 | 20712.098 | 19817.7209 |
| 42.0000000 | 20139.6332 | 250.70238 | 16922.1525 | 23968.908 | 19653.8133 | 20635.055 | 20713.298 | 19818.8692 |
| 42.5000000 | 20140.6997 | 251.01852 | 16922.9541 | 23970.311 | 19654.2707 | 20636.750 | 20714.395 | 19819.9188 |
| 43.0000000 | 20141.6740 | 251.27770 | 16923.6865 | 23971.593 | 19654.7456 | 20638.239 | 20715.397 | 19820.8776 |
| 43.5000000 | 20142.5643 | 251.50385 | 16924.3558 | 23972.764 | 19655.2002 | 20639.579 | 20716.313 | 19821.7537 |
| 44.0000000 | 20143.3787 | 251.76515 | 16924.9679 | 23973.836 | 19655.5112 | 20640.913 | 20717.151 | 19822.5551 |
| 44.5000000 | 20144.1233 | 252.02409 | 16925.5275 | 23974.816 | 19655.7569 | 20642.172 | 20717.916 | 19823.2879 |
| 45.0000000 | 20144.8032 | 252.21838 | 16926.0386 | 23975.710 | 19656.0625 | 20643.238 | 20718.616 | 19823.9569 |
| 45.5000000 | 20145.4244 | 252.38573 | 16926.5055 | 23976.528 | 19656.3613 | 20644.192 | 20719.255 | 19824.5682 |
| 46.0000000 | 20145.9931 | 252.60487 | 16926.9329 | 23977.276 | 19656.5078 | 20645.196 | 20719.839 | 19825.1279 |
| 46.5000000 | 20146.5120 | 252.74551 | 16927.3229 | 23977.959 | 19656.7557 | 20645.994 | 20720.373 | 19825.6385 |
| 47.0000000 | 20146.9868 | 252.91671 | 16927.6797 | 23978.583 | 19656.9007 | 20646.809 | 20720.861 | 19826.1057 |
| 47.5000000 | 20147.4204 | 253.05345 | 16928.0056 | 23979.154 | 19657.0709 | 20647.515 | 20721.307 | 19826.5324 |
| 48.0000000 | 20147.8165 | 253.16535 | 16928.3034 | 23979.675 | 19657.2514 | 20648.133 | 20721.715 | 19826.9222 |
| 48.5000000 | 20148.1789 | 253.29632 | 16928.5758 | 23980.152 | 19657.3615 | 20648.756 | 20722.088 | 19827.2789 |
| 49.0000000 | 20148.5101 | 253.41328 | 16928.8247 | 23980.588 | 19657.4673 | 20649.320 | 20722.428 | 19827.6048 |
| 49.5000000 | 20148.8130 | 253.53662 | 16929.0523 | 23980.987 | 19657.5327 | 20649.868 | 20722.740 | 19827.9029 |
| 50.0000000 | 20149.0899 | 253.65137 | 16929.2603 | 23981.351 | 19657.5884 | 20650.373 | 20723.024 | 19828.1753 |
| 50.5000000 | 20149.3423 | 253.71507 | 16929.4500 | 23981.683 | 19657.7181 | 20650.752 | 20723.284 | 19828.4237 |
| 51.0000000 | 20149.5732 | 253.79079 | 16929.6236 | 23981.987 | 19657.8032 | 20651.133 | 20723.521 | 19828.6509 |
| 51.5000000 | 20149.7844 | 253.87360 | 16929.7824 | 23982.265 | 19657.8549 | 20651.509 | 20723.739 | 19828.8588 |
| 52.0000000 | 20149.9774 | 253.94266 | 16929.9274 | 23982.519 | 19657.9148 | 20651.839 | 20723.937 | 19829.0487 |
| 52.5000000 | 20150.1540 | 254.02275 | 16930.0601 | 23982.751 | 19657.9372 | 20652.175 | 20724.119 | 19829.2225 |
| 53.0000000 | 20150.3152 | 254.08585 | 16930.1812 | 23982.963 | 19657.9768 | 20652.462 | 20724.285 | 19829.3812 |
| 53.5000000 | 20150.4625 | 254.13785 | 16930.2919 | 23983.157 | 19658.0239 | 20652.712 | 20724.436 | 19829.5261 |
| 54.0000000 | 20150.5972 | 254.19645 | 16930.3932 | 23983.334 | 19658.0458 | 20652.964 | 20724.575 | 19829.6587 |
| 54.5000000 | 20150.7201 | 254.22766 | 16930.4855 | 23983.496 | 19658.1085 | 20653.148 | 20724.701 | 19829.7796 |
| 55.0000000 | 20150.8328 | 254.28764 | 16930.5702 | 23983.644 | 19658.1057 | 20653.380 | 20724.817 | 19829.8905 |
| 55.5000000 | 20150.9355 | 254.32590 | 16930.6474 | 23983.780 | 19658.1347 | 20653.559 | 20724.923 | 19829.9916 |
| 56.0000000 | 20151.0294 | 254.36130 | 16930.7180 | 23983.903 | 19658.1605 | 20653.723 | 20725.019 | 19830.0840 |
| 56.5000000 | 20151.1154 | 254.40073 | 16930.7825 | 23984.016 | 19658.1704 | 20653.888 | 20725.108 | 19830.1686 |
| 57.0000000 | 20151.1938 | 254.43116 | 16930.8415 | 23984.120 | 19658.1903 | 20654.027 | 20725.188 | 19830.2458 |
| 57.5000000 | 20151.2656 | 254.46374 | 16930.8954 | 23984.214 | 19658.1993 | 20654.163 | 20725.262 | 19830.3164 |
| 58.0000000 | 20151.3311 | 254.48731 | 16930.9446 | 23984.300 | 19658.2194 | 20654.276 | 20725.329 | 19830.3808 |
| 58.5000000 | 20151.3911 | 254.51648 | 16930.9897 | 23984.379 | 19658.2231 | 20654.394 | 20725.391 | 19830.4398 |
| 59.0000000 | 20151.4458 | 254.54287 | 16931.0309 | 23984.451 | 19658.2271 | 20654.501 | 20725.447 | 19830.4938 |
| 59.5000000 | 20151.4959 | 254.56531 | 16931.0685 | 23984.517 | 19658.2339 | 20654.595 | 20725.499 | 19830.5430 |
| 60.0000000 | 20151.5417 | 254.58805 | 16931.1029 | 23984.577 | 19658.2359 | 20654.686 | 20725.546 | 19830.5881 |
| 60.5000000 | 20151.5834 | 254.60344 | 16931.1342 | 23984.632 | 19658.2480 | 20654.759 | 20725.589 | 19830.6292 |
| 61.0000000 | 20151.6217 | 254.62367 | 16931.1630 | 23984.683 | 19658.2473 | 20654.837 | 20725.628 | 19830.6668 |
| 61.5000000 | 20151.6566 | 254.64024 | 16931.1892 | 23984.729 | 19658.2503 | 20654.905 | 20725.664 | 19830.7012 |
| 62.0000000 | 20151.6886 | 254.65719 | 16931.2132 | 23984.771 | 19658.2496 | 20654.971 | 20725.697 | 19830.7326 |
| 62.5000000 | 20151.7177 | 254.67018 | 16931.2351 | 23984.809 | 19658.2537 | 20655.026 | 20725.727 | 19830.7613 |
| 63.0000000 | 20151.7444 | 254.68123 | 16931.2552 | 23984.844 | 19658.2591 | 20655.074 | 20725.755 | 19830.7875 |
| 63.5000000 | 20151.7688 | 254.69720 | 16931.2735 | 23984.876 | 19658.2528 | 20655.131 | 20725.780 | 19830.8116 |
| 64.0000000 | 20151.7911 | 254.70838 | 16931.2902 | 23984.906 | 19658.2535 | 20655.175 | 20725.803 | 19830.8335 |
| 64.5000000 | 20151.8114 | 254.71699 | 16931.3055 | 23984.932 | 19658.2572 | 20655.212 | 20725.823 | 19830.8535 |
| 65.0000000 | 20151.8300 | 254.72599 | 16931.3195 | 23984.957 | 19658.2585 | 20655.249 | 20725.843 | 19830.8718 |
| 65.5000000 | 20151.8470 | 254.73512 | 16931.3323 | 23984.979 | 19658.2579 | 20655.284 | 20725.860 | 19830.8885 |
| 66.0000000 | 20151.8625 | 254.74125 | 16931.3439 | 23985.000 | 19658.2616 | 20655.312 | 20725.876 | 19830.9038 |
| 66.5000000 | 20151.8767 | 254.74765 | 16931.3546 | 23985.018 | 19658.2635 | 20655.339 | 20725.891 | 19830.9178 |
| 67.0000000 | 20151.8897 | 254.75452 | 16931.3643 | 23985.035 | 19658.2632 | 20655.365 | 20725.904 | 19830.9305 |
| 67.5000000 | 20151.9016 | 254.76400 | 16931.3733 | 23985.051 | 19658.2569 | 20655.396 | 20725.916 | 19830.9423 |
| 68.0000000 | 20151.9124 | 254.76912 | 16931.3814 | 23985.065 | 19658.2579 | 20655.417 | 20725.927 | 19830.9529 |
| 68.5000000 | 20151.9224 | 254.77599 | 16931.3889 | 23985.078 | 19658.2546 | 20655.441 | 20725.938 | 19830.9627 |
| 69.0000000 | 20151.9314 | 254.77900 | 16931.3957 | 23985.090 | 19658.2578 | 20655.456 | 20725.947 | 19830.9716 |
| 69.5000000 | 20151.9397 | 254.78464 | 16931.4019 | 23985.101 | 19658.2552 | 20655.475 | 20725.955 | 19830.9797 |
| 70.0000000 | 20151.9473 | 254.78989 | 16931.4076 | 23985.111 | 19658.2527 | 20655.493 | 20725.963 | 19830.9872 |
| 70.5000000 | 20151.9542 | 254.79300 | 16931.4128 | 23985.120 | 19658.2536 | 20655.506 | 20725.970 | 19830.9940 |
| 71.0000000 | 20151.9605 | 254.79573 | 16931.4175 | 23985.129 | 19658.2547 | 20655.518 | 20725.977 | 19831.0002 |
| 71.5000000 | 20151.9663 | 254.79972 | 16931.4219 | 23985.136 | 19658.2528 | 20655.532 | 20725.983 | 19831.0059 |
| 72.0000000 | 20151.9716 | 254.80324 | 16931.4258 | 23985.143 | 19658.2513 | 20655.544 | 20725.988 | 19831.0111 |
| 72.5000000 | 20151.9764 | 254.80589 | 16931.4295 | 23985.150 | 19658.2510 | 20655.554 | 20725.993 | 19831.0158 |
| 73.0000000 | 20151.9808 | 254.80859 | 16931.4328 | 23985.155 | 19658.2502 | 20655.564 | 20725.998 | 19831.0202 |
| 73.5000000 | 20151.9848 | 254.81045 | 16931.4358 | 23985.161 | 19658.2506 | 20655.572 | 20726.002 | 19831.0241 |
| 74.0000000 | 20151.9885 | 254.81286 | 16931.4386 | 23985.165 | 19658.2497 | 20655.580 | 20726.006 | 19831.0278 |
| 74.5000000 | 20151.9919 | 254.81564 | 16931.4411 | 23985.170 | 19658.2477 | 20655.589 | 20726.009 | 19831.0311 |
| 75.0000000 | 20151.9949 | 254.81729 | 16931.4434 | 23985.174 | 19658.2476 | 20655.595 | 20726.012 | 19831.0341 |

``` r
pred_mass <- gw_pred_mass %>% 
    dplyr::select(age_yrs, mean_mass, sd_mass, female_mass, male_mass)


####################################################################
##### Calculate mean mass per month
MC_mass = NA

for (i in seq(from = 0, to = 12, by = 1)){  #step by 1 mths
    
    age_tibble <- age_yr_tibble %>% filter(age_mth == i)  
    age <- age_tibble$age_yrs   #calculate age_yrs (do not round up)
    
    strcolname <- as.character(age)
    
    pred_mass_i <- filter(pred_mass, age_yrs == age)
    
    mass <- pred_mass_i$mean_mass
    sd <- pred_mass_i$sd_mass
    
    set.seed(1)
    mass_i <- as_tibble(rnorm(MC_reps, mass, sd), col.names = str(i))
    names(mass_i)[1] <- strcolname
    
    mass_i <- mass_i %>%  dplyr::mutate(ID = row_number())
    
    #transpose the dataframe -- result is a matrix
    mass_i <-  t(mass_i)    
    
    #make ID the column name, then remove the unneeded row
    colnames(mass_i) <- unlist(mass_i[row.names(mass_i)=='ID',])
    mass_i  <- mass_i[!row.names(mass_i)=='ID',]
    
    #turn matrix into data frame (need to include the t() to keep the matrix format)
    mass_i <- as_tibble(t(mass_i))
    
    mass_i$age_yrs <- age
    
    mass_i$age_mth <- i
    
    MC_mass <- rbind(MC_mass, mass_i)
    
    
}

# move age_yrs to first column
MC_mass <- MC_mass %>%
  dplyr::select(age_yrs, everything())

MC_mass = MC_mass[-1,]

head(MC_mass)
```

    ## # A tibble: 6 × 12
    ##   age_yrs   `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10` age_mth
    ##     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>
    ## 1  0       966.  988.  961. 1026.  992.  961.  996. 1003.  998.  975.       0
    ## 2  0.0849 1475. 1505. 1467. 1558. 1510. 1468. 1516. 1526. 1520. 1487.       1
    ## 3  0.162  1970. 2014. 1959. 2089. 2021. 1960. 2030. 2043. 2034. 1988.       2
    ## 4  0.247  2536. 2593. 2522. 2693. 2604. 2523. 2615. 2633. 2621. 2559.       3
    ## 5  0.329  3083. 3150. 3065. 3266. 3162. 3066. 3175. 3195. 3182. 3109.       4
    ## 6  0.414  3629. 3703. 3610. 3831. 3716. 3611. 3730. 3753. 3738. 3658.       5

``` r
MC_mass_diffs <- NA

#### Calculate mass change (not sex-specific)
M_nb <- pred_mass %>% filter(age_yrs == 0) 

for (i in seq(from = 1, to = MC_reps, by = 1)){
    
    colnumber = i
    colname = as.character(colnumber)
    
    #mass_chg <- rnorm(1, M_nb$mean_mass, M_nb$sd_mass)     
    mass_chg <- MC_mass %>% 
        filter(age_yrs == 0) %>% 
        dplyr::select(colname)
    delta_mass <- mass_chg 
    
    
    delta_mass <- as.data.frame(mass_chg) 
    #names(delta_mass)[1] <- colname
    
    mass_column <- MC_mass %>% 
        dplyr:: select(colname)     
    
    str(mass_column)
    
    diffs_mass <-  diff(as.matrix(mass_column))  #calculate delta mass
    diffs_mass <- as.data.frame(diffs_mass) 
    names(diffs_mass)[1] <- as.character(colname)
    
    head(diffs_mass)
    
    mass_chg <- rbind(delta_mass, diffs_mass) 
    head(mass_chg)
    MC_mass_diffs <-cbind(MC_mass_diffs, mass_chg) 

}
```

    ## Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
    ## ℹ Please use `all_of()` or `any_of()` instead.
    ##   # Was:
    ##   data %>% select(colname)
    ## 
    ##   # Now:
    ##   data %>% select(all_of(colname))
    ## 
    ## See <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 1: num [1:13] 966 1475 1970 2536 3083 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 2: num [1:13] 988 1505 2014 2593 3150 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 3: num [1:13] 961 1467 1959 2522 3065 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 4: num [1:13] 1026 1558 2089 2693 3266 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 5: num [1:13] 992 1510 2021 2604 3162 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 6: num [1:13] 961 1468 1960 2523 3066 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 7: num [1:13] 996 1516 2030 2615 3175 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 8: num [1:13] 1003 1526 2043 2633 3195 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 9: num [1:13] 998 1520 2034 2621 3182 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 10: num [1:13] 975 1487 1988 2559 3109 ...

``` r
MC_mass_diffs  <-  MC_mass_diffs %>% 
    dplyr::select(-(MC_mass_diffs))

names(MC_mass_diffs)[0] <-  "age_yrs"

#add the age column and move to front
#MC_mass_diffs$age_yrs <- MC_mass$age_yrs

# MC_mass_diffs <- MC_mass_diffs %>%
#   dplyr::select(age_yrs, everything())


head(MC_mass_diffs)
```

    ##          1        2        3         4        5        6        7         8
    ## 1 966.2585 987.9429 960.6594 1025.7292 991.8474 961.0652 996.0746 1002.7905
    ## 2 508.7310 517.1363 506.5606  531.7831 518.6498 506.7179 520.2883  522.8916
    ## 3 495.4886 508.5111 492.1260  531.2035 510.8559 492.3697 513.3945  517.4277
    ## 4 565.8276 579.8683 562.2021  604.3350 582.3964 562.4649 585.1335  589.4821
    ## 5 546.2052 556.0691 543.6582  573.2575 557.8452 543.8428 559.7681  562.8230
    ## 6 546.4218 553.0306 544.7153  564.5468 554.2206 544.8390 555.5089  557.5557
    ##          9       10
    ## 1 998.4396 974.8527
    ## 2 521.2051 512.0623
    ## 3 514.8148 500.6498
    ## 4 586.6649 571.3923
    ## 5 560.8439 550.1145
    ## 6 556.2297 549.0410

``` r
str(MC_mass_diffs)
```

    ## 'data.frame':    13 obs. of  10 variables:
    ##  $ 1 : num  966 509 495 566 546 ...
    ##  $ 2 : num  988 517 509 580 556 ...
    ##  $ 3 : num  961 507 492 562 544 ...
    ##  $ 4 : num  1026 532 531 604 573 ...
    ##  $ 5 : num  992 519 511 582 558 ...
    ##  $ 6 : num  961 507 492 562 544 ...
    ##  $ 7 : num  996 520 513 585 560 ...
    ##  $ 8 : num  1003 523 517 589 563 ...
    ##  $ 9 : num  998 521 515 587 561 ...
    ##  $ 10: num  975 512 501 571 550 ...

``` r
MC_mass_diffs <- t(MC_mass_diffs)

#make ID the column name, then remove the unneeded row
colnames(MC_mass_diffs) <- unlist(MC_mass_diffs[row.names(MC_mass_diffs)=='age_yrs',])
MC_mass_diffs  <- MC_mass_diffs[!row.names(MC_mass_diffs)=='age_yrs',]
    
#turn matrix into data frame (need to include the t() to keep the matrix format)
MC_mass_diffs_t <- MC_mass_diffs %>% as_tibble()
```

    ## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
    ## `.name_repair` is omitted as of tibble 2.0.0.
    ## ℹ Using compatibility `.name_repair`.
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
head(MC_mass_diffs_t)
```

    ## # A tibble: 6 × 13
    ##      V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13
    ##   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1  966.  509.  495.  566.  546.  546.  502.  482.  440.  383.  233.  136.  140.
    ## 2  988.  517.  509.  580.  556.  553.  503.  482.  440.  385.  329.  132.  136.
    ## 3  961.  507.  492.  562.  544.  545.  502.  483.  441.  382.  209.  137.  141.
    ## 4 1026.  532.  531.  604.  573.  565.  506.  480.  438.  390.  496.  126.  129.
    ## 5  992.  519.  511.  582.  558.  554.  504.  481.  439.  386.  346.  131.  136.
    ## 6  961.  507.  492.  562.  544.  545.  502.  483.  441.  382.  210.  137.  141.

``` r
str(MC_mass_diffs_t)
```

    ## tibble [10 × 13] (S3: tbl_df/tbl/data.frame)
    ##  $ V1 : num [1:10] 966 988 961 1026 992 ...
    ##  $ V2 : num [1:10] 509 517 507 532 519 ...
    ##  $ V3 : num [1:10] 495 509 492 531 511 ...
    ##  $ V4 : num [1:10] 566 580 562 604 582 ...
    ##  $ V5 : num [1:10] 546 556 544 573 558 ...
    ##  $ V6 : num [1:10] 546 553 545 565 554 ...
    ##  $ V7 : num [1:10] 502 503 502 506 504 ...
    ##  $ V8 : num [1:10] 482 482 483 480 481 ...
    ##  $ V9 : num [1:10] 440 440 441 438 439 ...
    ##  $ V10: num [1:10] 383 385 382 390 386 ...
    ##  $ V11: num [1:10] 233 329 209 496 346 ...
    ##  $ V12: num [1:10] 136 132 137 126 131 ...
    ##  $ V13: num [1:10] 140 136 141 129 136 ...

``` r
MC_mass_diffs_t %>% write_csv("data/MC_mass_diffs_t.csv", na = "", append = FALSE)

####################################################################
##### Calulate mean  mass change (not sex-specific) across all columns (ages)

mean_masschange <- MC_mass_diffs_t %>% summarise_all(funs(mean))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
kable(head(mean_masschange))
```

| V1 | V2 | V3 | V4 | V5 | V6 | V7 | V8 | V9 | V10 | V11 | V12 | V13 |
|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 986.566 | 516.6026 | 507.6841 | 578.9767 | 555.4428 | 552.6109 | 503.338 | 481.637 | 439.6587 | 385.3029 | 322.8964 | 132.2494 | 136.6101 |

``` r
mean_masschange <-  t(mean_masschange)

mean_masschange <- as_tibble(mean_masschange)
colnames(mean_masschange)[colnames(mean_masschange)=="V1"] <- "mean_masschange"

mean_masschange$age_yrs <- MC_mass$age_yrs
mean_masschange <- mean_masschange %>%
  dplyr::select(age_yrs, everything())

#calculate sd for mass changes across all columns (ages)
sd_masschange <- MC_mass_diffs_t %>% summarise_all(funs(sd))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
sd_masschange <-  t(sd_masschange)

sd_masschange <- as_tibble(sd_masschange)
colnames(sd_masschange)[colnames(sd_masschange)=="V1"] <- "sd_masschange"

mean_masschange$sd_masschange <- sd_masschange$sd_masschange
mean_masschange$sex <- "N/A"


###########################################################################
# Calculate mass change for females

MC_female_mass = NA

for (i in seq(from = 0, to = 12, by = 1)){  #step by 0.5 mths
    
    age_tibble <- age_yr_tibble %>% filter(age_mth == i)  
    age <- age_tibble$age_yrs   #calculate age_yrs (do not round up)
    
    strcolname <- as.character(age)
    
    pred_mass_i <- filter(pred_mass, age_yrs == age)
    
    mass <- pred_mass_i$female_mass
    sd <- pred_mass_i$sd_mass
    
    set.seed(1)
    mass_i <- as_tibble(rnorm(MC_reps, mass, sd), col.names = str(i))
    names(mass_i)[1] <- strcolname
    
    mass_i <- mass_i %>%  dplyr::mutate(ID = row_number())
    
    #transpose the dataframe -- result is a matrix
    mass_i <-  t(mass_i)    
    
    #make ID the column name, then remove the unneeded row
    colnames(mass_i) <- unlist(mass_i[row.names(mass_i)=='ID',])
    mass_i  <- mass_i[!row.names(mass_i)=='ID',]
    
    #turn matrix into data frame (need to include the t() to keep the matrix format)
    mass_i <- as_tibble(t(mass_i))
    
    mass_i$age_yrs <- age
    
    mass_i$age_mth <- i
    
    MC_female_mass <- rbind(MC_female_mass, mass_i)
    
    
}

# move age_yrs to first column
MC_female_mass <- MC_female_mass %>%
  dplyr::select(age_yrs, everything())

MC_female_mass = MC_female_mass[-1,]

head(MC_female_mass)
```

    ## # A tibble: 6 × 12
    ##   age_yrs   `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10` age_mth
    ##     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>
    ## 1  0       994. 1016.  989. 1054. 1020.  989. 1024. 1031. 1026. 1003.       0
    ## 2  0.0849 1518. 1548. 1510. 1600. 1553. 1510. 1559. 1568. 1562. 1530.       1
    ## 3  0.162  2028. 2071. 2016. 2146. 2078. 2017. 2087. 2100. 2092. 2045.       2
    ## 4  0.247  2610. 2667. 2595. 2767. 2677. 2596. 2688. 2706. 2695. 2632.       3
    ## 5  0.329  3172. 3239. 3154. 3356. 3251. 3156. 3264. 3285. 3271. 3198.       4
    ## 6  0.414  3734. 3808. 3715. 3936. 3821. 3716. 3835. 3858. 3843. 3763.       5

``` r
MC_female_mass_diffs <- NA

#### Calculate mass change for females
##first row must start at 0 because no chnange in mass from 0 to 0
M_nb <- pred_mass %>% filter(age_yrs == 0) 
    

for (i in seq(from = 1, to = MC_reps, by = 1)){
    
    colnumber = i
    colname = as.character(colnumber)
    
    #mass_chg <- rnorm(1, M_nb$mean_mass, M_nb$sd_mass)     
    mass_chg_Female <- MC_mass %>% 
        dplyr::filter(age_yrs == 0) %>% 
        dplyr::select(colname)
    delta_mass <- mass_chg_Female 
        
    delta_mass <- as.data.frame(mass_chg_Female) 
    names(delta_mass)[1] <- colname
    
    mass_column <- MC_female_mass %>% 
        dplyr:: select(colname)     
    
    str(mass_column)
    
    diffs_mass_Female <-  diff(as.matrix(mass_column))  #calculate delta mass
    diffs_mass_Female <- as.data.frame(diffs_mass_Female) 
    names(diffs_mass_Female)[1] <- as.character(colname)
    
    head(diffs_mass_Female)
    
    mass_chg_Female <- rbind(delta_mass, diffs_mass_Female) 
    head(mass_chg_Female)
    MC_female_mass_diffs <-cbind(MC_female_mass_diffs, mass_chg_Female) 

}
```

    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 1: num [1:13] 994 1518 2028 2610 3172 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 2: num [1:13] 1016 1548 2071 2667 3239 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 3: num [1:13] 989 1510 2016 2595 3154 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 4: num [1:13] 1054 1600 2146 2767 3356 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 5: num [1:13] 1020 1553 2078 2677 3251 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 6: num [1:13] 989 1510 2017 2596 3156 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 7: num [1:13] 1024 1559 2087 2688 3264 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 8: num [1:13] 1031 1568 2100 2706 3285 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 9: num [1:13] 1026 1562 2092 2695 3271 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 10: num [1:13] 1003 1530 2045 2632 3198 ...

``` r
MC_female_mass_diffs  <-  MC_female_mass_diffs %>% 
    dplyr::select(-(MC_female_mass_diffs))

#add the age column and move to front
MC_female_mass_diffs$age_yrs <- MC_female_mass$age_yrs
MC_female_mass_diffs <- MC_female_mass_diffs %>%
  dplyr::select(age_yrs, everything())

head(MC_female_mass_diffs)
```

    ##      age_yrs        1        2        3         4        5        6        7
    ## 1 0.00000000 966.2585 987.9429 960.6594 1025.7292 991.8474 961.0652 996.0746
    ## 2 0.08493151 523.4070 531.8124 521.2367  546.4592 533.3258 521.3940 534.9644
    ## 3 0.16164384 509.8891 522.9116 506.5266  545.6040 525.2564 506.7703 527.7950
    ## 4 0.24657534 582.2541 596.2948 578.6286  620.7615 598.8230 578.8914 601.5601
    ## 5 0.32876712 561.9808 571.8447 559.4338  589.0331 573.6208 559.6184 575.5437
    ## 6 0.41369863 562.1318 568.7406 560.4254  580.2569 569.9306 560.5491 571.2189
    ##           8        9       10
    ## 1 1002.7905 998.4396 974.8527
    ## 2  537.5676 535.8811 526.7383
    ## 3  531.8282 529.2153 515.0503
    ## 4  605.9086 603.0914 587.8188
    ## 5  578.5986 576.6195 565.8901
    ## 6  573.2658 571.9397 564.7511

``` r
str(MC_female_mass_diffs)
```

    ## 'data.frame':    13 obs. of  11 variables:
    ##  $ age_yrs: num  0 0.0849 0.1616 0.2466 0.3288 ...
    ##  $ 1      : num  966 523 510 582 562 ...
    ##  $ 2      : num  988 532 523 596 572 ...
    ##  $ 3      : num  961 521 507 579 559 ...
    ##  $ 4      : num  1026 546 546 621 589 ...
    ##  $ 5      : num  992 533 525 599 574 ...
    ##  $ 6      : num  961 521 507 579 560 ...
    ##  $ 7      : num  996 535 528 602 576 ...
    ##  $ 8      : num  1003 538 532 606 579 ...
    ##  $ 9      : num  998 536 529 603 577 ...
    ##  $ 10     : num  975 527 515 588 566 ...

``` r
MC_female_mass_diffs <- t(MC_female_mass_diffs)

#make ID the column name, then remove the unneeded row
colnames(MC_female_mass_diffs) <- unlist(MC_female_mass_diffs[row.names(MC_female_mass_diffs)=='age_yrs',])
MC_female_mass_diffs  <- MC_female_mass_diffs[!row.names(MC_female_mass_diffs)=='age_yrs',]
    
#turn matrix into data frame (need to include the t() to keep the matrix format)
MC_female_mass_diffs_t <- MC_female_mass_diffs %>% as_tibble()


head(MC_female_mass_diffs_t)
```

    ## # A tibble: 6 × 13
    ##     `0` `0.0849315068493151` `0.161643835616438` `0.246575342465753`
    ##   <dbl>                <dbl>               <dbl>               <dbl>
    ## 1  966.                 523.                510.                582.
    ## 2  988.                 532.                523.                596.
    ## 3  961.                 521.                507.                579.
    ## 4 1026.                 546.                546.                621.
    ## 5  992.                 533.                525.                599.
    ## 6  961.                 521.                507.                579.
    ## # ℹ 9 more variables: `0.328767123287671` <dbl>, `0.413698630136986` <dbl>,
    ## #   `0.495890410958904` <dbl>, `0.580821917808219` <dbl>,
    ## #   `0.665753424657534` <dbl>, `0.747945205479452` <dbl>,
    ## #   `0.832876712328767` <dbl>, `0.915068493150685` <dbl>, `1` <dbl>

``` r
str(MC_female_mass_diffs_t)
```

    ## tibble [10 × 13] (S3: tbl_df/tbl/data.frame)
    ##  $ 0                 : num [1:10] 966 988 961 1026 992 ...
    ##  $ 0.0849315068493151: num [1:10] 523 532 521 546 533 ...
    ##  $ 0.161643835616438 : num [1:10] 510 523 507 546 525 ...
    ##  $ 0.246575342465753 : num [1:10] 582 596 579 621 599 ...
    ##  $ 0.328767123287671 : num [1:10] 562 572 559 589 574 ...
    ##  $ 0.413698630136986 : num [1:10] 562 569 560 580 570 ...
    ##  $ 0.495890410958904 : num [1:10] 516 518 516 520 518 ...
    ##  $ 0.580821917808219 : num [1:10] 496 495 496 494 495 ...
    ##  $ 0.665753424657534 : num [1:10] 453 452 453 451 452 ...
    ##  $ 0.747945205479452 : num [1:10] 394 396 393 401 397 ...
    ##  $ 0.832876712328767 : num [1:10] 242 338 217 505 355 ...
    ##  $ 0.915068493150685 : num [1:10] 139 136 140 129 135 ...
    ##  $ 1                 : num [1:10] 144 140 145 133 140 ...

``` r
MC_female_mass_diffs_t %>% write_csv("data/MC_female_mass_diffs_t.csv", na = "", append = FALSE)


#calculate mean mass changes across all columns (ages)
mean_masschange_female <- MC_female_mass_diffs_t %>% summarise_all(funs(mean))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
kable(head(mean_masschange_female))
```

| 0 | 0.0849315068493151 | 0.161643835616438 | 0.246575342465753 | 0.328767123287671 | 0.413698630136986 | 0.495890410958904 | 0.580821917808219 | 0.665753424657534 | 0.747945205479452 | 0.832876712328767 | 0.915068493150685 | 1 |
|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 986.566 | 531.2787 | 522.0847 | 595.4032 | 571.2184 | 568.321 | 517.6693 | 495.36 | 452.1858 | 396.2667 | 331.6488 | 136.0333 | 140.5203 |

``` r
mean_masschange_female <-  t(mean_masschange_female)

mean_masschange_female <- as_tibble(mean_masschange_female)
colnames(mean_masschange_female)[colnames(mean_masschange_female)=="V1"] <- "mean_masschange"

mean_masschange_female$age_yrs <- MC_female_mass$age_yrs
mean_masschange_female <- mean_masschange_female %>%
  dplyr::select(age_yrs, everything())

#calculate sd for mass changes across all columns (ages)
sd_masschange_female <- MC_female_mass_diffs_t %>% summarise_all(funs(sd))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
sd_masschange_female <-  t(sd_masschange_female)

sd_masschange_female <- as_tibble(sd_masschange_female)
colnames(sd_masschange_female)[colnames(sd_masschange_female)=="V1"] <- "sd_masschange"

mean_masschange_female$sd_masschange <- sd_masschange_female$sd_masschange
mean_masschange_female$sex <- "Female"



####################################################################
##### Calulate mass change for males
MC_male_mass = NA

for (i in seq(from = 0, to = 12, by = 1)){  #step by 0.5 mths
    
    age_tibble <- age_yr_tibble %>% filter(age_mth == i)  
    age <- age_tibble$age_yrs   #calculate age_yrs (do not round up)
    
    strcolname <- as.character(age)
    
    pred_mass_i <- filter(pred_mass, age_yrs == age)
    
    mass <- pred_mass_i$male_mass
    sd <- pred_mass_i$sd_mass
    
    set.seed(1)
    mass_i <- as_tibble(rnorm(MC_reps, mass, sd), col.names = str(i))
    names(mass_i)[1] <- strcolname
    
    mass_i <- mass_i %>%  dplyr::mutate(ID = row_number())
    
    #transpose the dataframe -- result is a matrix
    mass_i <-  t(mass_i)    
    
    #make ID the column name, then remove the unneeded row
    colnames(mass_i) <- unlist(mass_i[row.names(mass_i)=='ID',])
    mass_i  <- mass_i[!row.names(mass_i)=='ID',]
    
    #turn matrix into data frame (need to include the t() to keep the matrix format)
    mass_i <- as_tibble(t(mass_i))
    
    mass_i$age_yrs <- age
    
    mass_i$age_mth <- i
    
    MC_male_mass <- rbind(MC_male_mass, mass_i)
    
    
}

# move age_yrs to first column
MC_male_mass <- MC_male_mass %>%
  dplyr::select(age_yrs, everything())

MC_male_mass = MC_male_mass[-1,]

head(MC_male_mass)
```

    ## # A tibble: 6 × 12
    ##   age_yrs   `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10` age_mth
    ##     <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>
    ## 1  0       951.  972.  945. 1010.  976.  945.  980.  987.  983.  959.       0
    ## 2  0.0849 1451. 1481. 1443. 1534. 1487. 1444. 1493. 1502. 1496. 1463.       1
    ## 3  0.162  1939. 1982. 1927. 2057. 1989. 1928. 1998. 2011. 2003. 1956.       2
    ## 4  0.247  2495. 2552. 2480. 2652. 2563. 2482. 2574. 2591. 2580. 2518.       3
    ## 5  0.329  3033. 3100. 3015. 3216. 3112. 3017. 3125. 3145. 3132. 3059.       4
    ## 6  0.414  3570. 3644. 3551. 3772. 3657. 3553. 3671. 3694. 3679. 3599.       5

``` r
MC_male_mass_diffs <- NA

#### Calculate mass change for males
##first row must start at 0 because no chnange in mass from 0 to 0


for (i in seq(from = 1, to = MC_reps, by = 1)){
    
    colnumber = i
    colname = as.character(colnumber)
    
    #mass_chg <- rnorm(1, M_nb$mean_mass, M_nb$sd_mass)     
    mass_chg_male <- MC_mass %>% 
        dplyr::filter(age_yrs == 0) %>% 
        dplyr::select(colname)
    delta_mass <- mass_chg_male 
    
    
    delta_mass <- as.data.frame(mass_chg_male) 
    names(delta_mass)[1] <- colname
    
    mass_column <- MC_male_mass %>% 
        dplyr:: select(colname)     
    
    str(mass_column)
    
    diffs_mass_male <-  diff(as.matrix(mass_column))  #calculate delta mass
    diffs_mass_male <- as.data.frame(diffs_mass_male) 
    names(diffs_mass_male)[1] <- as.character(colname)
    
    head(diffs_mass_male)
    
    mass_chg_male <- rbind(delta_mass, diffs_mass_male) 
    head(mass_chg_male)
    MC_male_mass_diffs <-cbind(MC_male_mass_diffs, mass_chg_male) 

}
```

    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 1: num [1:13] 951 1451 1939 2495 3033 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 2: num [1:13] 972 1481 1982 2552 3100 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 3: num [1:13] 945 1443 1927 2480 3015 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 4: num [1:13] 1010 1534 2057 2652 3216 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 5: num [1:13] 976 1487 1989 2563 3112 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 6: num [1:13] 945 1444 1928 2482 3017 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 7: num [1:13] 980 1493 1998 2574 3125 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 8: num [1:13] 987 1502 2011 2591 3145 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 9: num [1:13] 983 1496 2003 2580 3132 ...
    ## tibble [13 × 1] (S3: tbl_df/tbl/data.frame)
    ##  $ 10: num [1:13] 959 1463 1956 2518 3059 ...

``` r
MC_male_mass_diffs  <-  MC_male_mass_diffs %>% 
    dplyr::select(-(MC_male_mass_diffs))

#add the age column and move to front
MC_male_mass_diffs$age_yrs <- MC_male_mass$age_yrs
MC_male_mass_diffs <- MC_male_mass_diffs %>%
  dplyr::select(age_yrs, everything())


head(MC_male_mass_diffs)
```

    ##      age_yrs        1        2        3         4        5        6        7
    ## 1 0.00000000 966.2585 987.9429 960.6594 1025.7292 991.8474 961.0652 996.0746
    ## 2 0.08493151 500.5249 508.9303 498.3546  523.5771 510.4437 498.5119 512.0823
    ## 3 0.16164384 487.4365 500.4590 484.0740  523.1514 502.8038 484.3177 505.3425
    ## 4 0.24657534 556.6427 570.6834 553.0172  595.1501 573.2116 553.2800 575.9487
    ## 5 0.32876712 537.3843 547.2482 534.8373  564.4366 549.0243 535.0219 550.9472
    ## 6 0.41369863 537.6375 544.2463 535.9311  555.7625 545.4363 536.0547 546.7246
    ##           8        9       10
    ## 1 1002.7905 998.4396 974.8527
    ## 2  514.6855 512.9990 503.8562
    ## 3  509.3757 506.7627 492.5977
    ## 4  580.2972 577.4800 562.2074
    ## 5  554.0021 552.0230 541.2936
    ## 6  548.7714 547.4454 540.2568

``` r
str(MC_male_mass_diffs)
```

    ## 'data.frame':    13 obs. of  11 variables:
    ##  $ age_yrs: num  0 0.0849 0.1616 0.2466 0.3288 ...
    ##  $ 1      : num  966 501 487 557 537 ...
    ##  $ 2      : num  988 509 500 571 547 ...
    ##  $ 3      : num  961 498 484 553 535 ...
    ##  $ 4      : num  1026 524 523 595 564 ...
    ##  $ 5      : num  992 510 503 573 549 ...
    ##  $ 6      : num  961 499 484 553 535 ...
    ##  $ 7      : num  996 512 505 576 551 ...
    ##  $ 8      : num  1003 515 509 580 554 ...
    ##  $ 9      : num  998 513 507 577 552 ...
    ##  $ 10     : num  975 504 493 562 541 ...

``` r
MC_male_mass_diffs <- t(MC_male_mass_diffs)

#make ID the column name, then remove the unneeded row
colnames(MC_male_mass_diffs) <- unlist(MC_male_mass_diffs[row.names(MC_male_mass_diffs)=='age_yrs',])
MC_male_mass_diffs  <- MC_male_mass_diffs[!row.names(MC_male_mass_diffs)=='age_yrs',]
    
#turn matrix into data frame (need to include the t() to keep the matrix format)
MC_male_mass_diffs_t <- MC_male_mass_diffs %>% as_tibble()

head(MC_male_mass_diffs_t)
```

    ## # A tibble: 6 × 13
    ##     `0` `0.0849315068493151` `0.161643835616438` `0.246575342465753`
    ##   <dbl>                <dbl>               <dbl>               <dbl>
    ## 1  966.                 501.                487.                557.
    ## 2  988.                 509.                500.                571.
    ## 3  961.                 498.                484.                553.
    ## 4 1026.                 524.                523.                595.
    ## 5  992.                 510.                503.                573.
    ## 6  961.                 499.                484.                553.
    ## # ℹ 9 more variables: `0.328767123287671` <dbl>, `0.413698630136986` <dbl>,
    ## #   `0.495890410958904` <dbl>, `0.580821917808219` <dbl>,
    ## #   `0.665753424657534` <dbl>, `0.747945205479452` <dbl>,
    ## #   `0.832876712328767` <dbl>, `0.915068493150685` <dbl>, `1` <dbl>

``` r
str(MC_male_mass_diffs_t)
```

    ## tibble [10 × 13] (S3: tbl_df/tbl/data.frame)
    ##  $ 0                 : num [1:10] 966 988 961 1026 992 ...
    ##  $ 0.0849315068493151: num [1:10] 501 509 498 524 510 ...
    ##  $ 0.161643835616438 : num [1:10] 487 500 484 523 503 ...
    ##  $ 0.246575342465753 : num [1:10] 557 571 553 595 573 ...
    ##  $ 0.328767123287671 : num [1:10] 537 547 535 564 549 ...
    ##  $ 0.413698630136986 : num [1:10] 538 544 536 556 545 ...
    ##  $ 0.495890410958904 : num [1:10] 494 495 494 498 496 ...
    ##  $ 0.580821917808219 : num [1:10] 475 474 475 472 474 ...
    ##  $ 0.665753424657534 : num [1:10] 433 433 434 431 432 ...
    ##  $ 0.747945205479452 : num [1:10] 377 379 376 384 380 ...
    ##  $ 0.832876712328767 : num [1:10] 228 324 204 491 341 ...
    ##  $ 0.915068493150685 : num [1:10] 134 130 134 124 129 ...
    ##  $ 1                 : num [1:10] 138 134 139 127 133 ...

``` r
MC_male_mass_diffs_t %>% write_csv("data/MC_male_mass_diffs_t.csv", na = "", append = FALSE)


#calculate mean mass changes across all columns (ages)
mean_masschange_male <- MC_male_mass_diffs_t %>% summarise_all(funs(mean))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
kable(head(mean_masschange_male))
```

| 0 | 0.0849315068493151 | 0.161643835616438 | 0.246575342465753 | 0.328767123287671 | 0.413698630136986 | 0.495890410958904 | 0.580821917808219 | 0.665753424657534 | 0.747945205479452 | 0.832876712328767 | 0.915068493150685 | 1 |
|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 986.566 | 508.3965 | 499.6321 | 569.7918 | 546.6219 | 543.8267 | 495.3246 | 473.9637 | 432.6542 | 379.1726 | 318.0025 | 130.1336 | 134.4237 |

``` r
mean_masschange_male <-  t(mean_masschange_male)

mean_masschange_male <- as_tibble(mean_masschange_male)
colnames(mean_masschange_male)[colnames(mean_masschange_male)=="V1"] <- "mean_masschange"

mean_masschange_male$age_yrs <- MC_male_mass$age_yrs
mean_masschange_male <- mean_masschange_male %>%
  relocate(age_yrs)

#calculate sd for mass changes across all columns (ages)
sd_masschange_male <- MC_male_mass_diffs_t %>% summarise_all(funs(sd))
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## ℹ Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
sd_masschange_male <-  t(sd_masschange_male)

sd_masschange_male <- as_tibble(sd_masschange_male)
colnames(sd_masschange_male)[colnames(sd_masschange_male)=="V1"] <- "sd_masschange"

mean_masschange_male$sd_masschange <- sd_masschange_male$sd_masschange
mean_masschange_male$sex <- "Male"
```

Combine mass change tables into one for plotting

``` r
mean_masschange <- rbind(mean_masschange, mean_masschange_female, mean_masschange_male)

kable(mean_masschange)
```

|   age_yrs | mean_masschange | sd_masschange | sex    |
|----------:|----------------:|--------------:|:-------|
| 0.0000000 |        986.5660 |    20.8944895 | N/A    |
| 0.0849315 |        516.6026 |     8.0991611 | N/A    |
| 0.1616438 |        507.6841 |    12.5481058 | N/A    |
| 0.2465753 |        578.9767 |    13.5292261 | N/A    |
| 0.3287671 |        555.4428 |     9.5046028 | N/A    |
| 0.4136986 |        552.6109 |     6.3680569 | N/A    |
| 0.4958904 |        503.3380 |     1.2286994 | N/A    |
| 0.5808219 |        481.6370 |     0.8153022 | N/A    |
| 0.6657534 |        439.6587 |     0.7704506 | N/A    |
| 0.7479452 |        385.3029 |     2.3579711 | N/A    |
| 0.8328767 |        322.8964 |    92.2594101 | N/A    |
| 0.9150685 |        132.2494 |     3.5075607 | N/A    |
| 1.0000000 |        136.6101 |     3.9314679 | N/A    |
| 0.0000000 |        986.5660 |    20.8944895 | Female |
| 0.0849315 |        531.2787 |     8.0991611 | Female |
| 0.1616438 |        522.0847 |    12.5481058 | Female |
| 0.2465753 |        595.4032 |    13.5292261 | Female |
| 0.3287671 |        571.2184 |     9.5046028 | Female |
| 0.4136986 |        568.3210 |     6.3680569 | Female |
| 0.4958904 |        517.6693 |     1.2286994 | Female |
| 0.5808219 |        495.3600 |     0.8153022 | Female |
| 0.6657534 |        452.1858 |     0.7704506 | Female |
| 0.7479452 |        396.2667 |     2.3579711 | Female |
| 0.8328767 |        331.6488 |    92.2594101 | Female |
| 0.9150685 |        136.0333 |     3.5075607 | Female |
| 1.0000000 |        140.5203 |     3.9314679 | Female |
| 0.0000000 |        986.5660 |    20.8944895 | Male   |
| 0.0849315 |        508.3965 |     8.0991611 | Male   |
| 0.1616438 |        499.6321 |    12.5481058 | Male   |
| 0.2465753 |        569.7918 |    13.5292261 | Male   |
| 0.3287671 |        546.6219 |     9.5046028 | Male   |
| 0.4136986 |        543.8267 |     6.3680569 | Male   |
| 0.4958904 |        495.3246 |     1.2286994 | Male   |
| 0.5808219 |        473.9637 |     0.8153022 | Male   |
| 0.6657534 |        432.6542 |     0.7704506 | Male   |
| 0.7479452 |        379.1726 |     2.3579711 | Male   |
| 0.8328767 |        318.0025 |    92.2594101 | Male   |
| 0.9150685 |        130.1336 |     3.5075607 | Male   |
| 1.0000000 |        134.4237 |     3.9314679 | Male   |

``` r
#keep this 
mean_masschange$age_mth <- round(mean_masschange$age_yrs * 12)

mean_masschange %>% write_csv("data/mean_masschange.csv", na = "", append = FALSE)

mean_masschange <- as_tibble(read_csv("data/mean_masschange.csv"))
```

    ## Rows: 39 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): sex
    ## dbl (4): age_yrs, mean_masschange, sd_masschange, age_mth
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Mean mass change by sex

    ## Warning: Removed 3 rows containing missing values or values outside the scale range
    ## (`geom_line()`).

![](mass_change_per_month_files/figure-gfm/plot%20mean%20mass%20change%20by%20sex-1.png)<!-- -->

Mean mass change (not sex-specific)

    ## Warning: Removed 1 row containing missing values or values outside the scale range
    ## (`geom_point()`).

![](mass_change_per_month_files/figure-gfm/plot%20mean%20mass%20change%20NA-1.png)<!-- -->![](mass_change_per_month_files/figure-gfm/plot%20mean%20mass%20change%20NA-2.png)<!-- -->
